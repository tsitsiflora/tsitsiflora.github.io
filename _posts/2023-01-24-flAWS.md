---
layout: post
title:  "AWS Security: A series of common mistakes"
date:   2023-01-24 14:20:20 +0200
categories: security, aws
---

# AWS Security: A series of common mistakes

I have decided to take initiative and learn AWS security given the wide adoption of the cloud. Last year I sat for the AWS Cloud Pactitioner exam and passed, and I am hoping I can do another one. I've been contemplating doing the Solutions Architect but I am not really sure I need it. My goal is to pass the AWS Certified Security, since it is specialized. But I'm not sure if I can jump the steps like that. I'm gonna be using the [flAWS](http://flaws.cloud/) project by Scot Piper. 

In his own words, "Through a series of levels you'll learn about common mistakes and gotchas when using Amazon Web Services (AWS). There are no SQL injection, XSS, buffer overflows, or many of the other vulnerabilities you might have seen before. As much as possible, these are AWS specific issues." That is the flAWS project. I'll be doing more research into the mistakes and providing more details.

## Level 1

`This level is **buckets** of fun. See if you can find the first sub-domain.`

## Common Mistake Explanation: Exposed S3 buckets

Amazon Simple Storage Service is an object storage service that stores data as objects inside buckets. An object is a file and any metadata that describes the file. Amazon S3 provides the ability to store an serve static content from Amazon's Cloud. Businesses use S3 to store all types of data in S3 buckets: data lakes, websites, mobile applications, backup and restore, archive, enterprise applications, IoT devices, and big data analytics. Access controls can be applied to both the bucket itself and to individual objects(files and directories) stored within the bucket. 

A bucket is typically considered “public” if any user can list the contents of the bucket, and “private” if the bucket's contents can only be listed or written by certain S3 users. A public bucket will list all of it's files and directories to any user that asks. Checking if a bucket is public or private is easy. All buckets have a predictable and publicly accessible URL. By default this URL will be either of the following:

`http://s3.amazonaws.com/[bucket_name]/`

`http://[bucket_name].s3.amazonaws.com/`

To test the openness of the bucket a user can just enter the URL in their web browser. A private bucket will respond with "Access Denied". A public bucket will list the first 1,000 objects that have been stored. The security risk from a public bucket is simple, and similar to the common [Directory Listing Vulnerability](https://cwe.mitre.org/data/definitions/548.html). A list of files and the files themselves - if available for download - can reveal sensitive information. The worst case scenario is that a bucket has been marked as "public", exposes a list of sensitive files, and no access controls have been placed on those files. In situations where the bucket is public, but the files are locked down, sensitive information can still be exposed through the file names themselves, such as the names of customers or how frequently a particular application is backed up. 

And according to [Amazon](https://aws.amazon.com/articles/amazon-s3-bucket-public-access-considerations/) themselves in regard to this issue: "Bucket public "READ" access: This is sometimes referred to as "list" access. It allows anyone to get a complete list of your bucket content. It does not grant permissions to read content of an object. However, a list of object names can often provide more information than necessary to the public."

### More research
- [Rapid7 Blog](https://www.rapid7.com/blog/post/2013/03/27/open-s3-buckets/)
- [Robin Wood's blog](https://digi.ninja/blog/analysing_amazons_buckets.php)

### Hint 1

In the first hint we are told that the site is hosted in S# buckets as it is a great way to host static sites. Let's do a DNS lookup on the domain to confirm this:


    dig +nocmd flaws.cloud any +multiline +noall +answer

Returns:



**This article is not finished yet. But you can read what's there right now if you want :)




